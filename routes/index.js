var express = require('express');
var router = express.Router();
var request = require('request');

/* GET home page. */
router.get('/', function(req, res, next) {
  res.render('index', { title: 'Express' });
});


router.post('/getOpayStatus',function(req,res,next){
  var donateUrl = 'https://payment.opay.tw/Broadcaster/CheckDonate/93DE5CBA396ABCB7607DDC8901AD147A'
  var options = {
    'method': 'POST',
    'url': donateUrl,
    'headers': {
      'authority': 'payment.opay.tw',
      'sec-ch-ua': '" Not;A Brand";v="99", "Google Chrome";v="97", "Chromium";v="97"',
      'accept': 'application/json, text/javascript, */*; q=0.01',
      'content-type': 'application/x-www-form-urlencoded; charset=UTF-8',
      'x-requested-with': 'XMLHttpRequest',
      'sec-ch-ua-mobile': '?0',
      'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36',
      'sec-ch-ua-platform': '"Windows"',
      'origin': 'https://payment.opay.tw',
      'sec-fetch-site': 'same-origin',
      'sec-fetch-mode': 'cors',
      'sec-fetch-dest': 'empty',
      'accept-language': 'zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7,ja;q=0.6',
      'cookie': '_ga=GA1.2.165091369.1630145004; opay_opay_opay_ext=apa_=93937ce6ef4f013874fc82b1fabd0541; IschangNickName=N; _gid=GA1.2.1832870583.1642692217; opay_opay_opay=apc_=cc5f65dcc318c25c68c4a0d42553b6ce20308ef73c0ad2c5b7715acd0c94b7fe9f8ddcba933ea18e97c6426e54d47d0737daa61b0c3a538da812a2a74a87309e5051ef1e91d0930ce266321ed53f86edb2fcf8bf2479cb868c75f1cc34169eb1dc25c70764b7a5387173dcb3b7a6007091ac2a69cd08fb467582e58e31ae0283a004c3816316d24a7b79dd8ad68028badd73615d56b85ff7ce2c7fa72bb0fbda0cf9effbbd432f2e2f74ba61b78d93f099f1c37a61f8a727476992080bf74c2df6492c0022ba59616d71e1de3203a490050a0d4743b7c64545c9295c747e50da18a4ae12141153c0bb051250fc1ea7654778d3b7e510432bb5fce783d485b2c84556349188938d5a396e95ef0d92c758da1ab71b24b04d8bf004f97d1cd6bb0985585cc1813e9e479b45f7d689d386ad0934cca60e276b2a98fffd6db464be54bcbbbb7b634753f64f6d8b9582e9e4fa5c196659c3d6218ff23e42ff2f97c3e78a916c2faa34901cf0097da8650159684ea484501c6e5d0bd05ace3b317dcce74dca6fc6d4e895ead6baeae8e48d8099a15b2c53da622c91e1549f011e1b174a1435a73356a28023c49d30bbaa0de150696053f8f1c65d5cedb177ec8526dec463f1f3c66c3a987e297fbe508d674185f63fa7299262ecee4d2083da578f59ab91d8cb9c0f63007cc1c2bf08b5dabf4baa790e3a5eaec0cc90cd6cbc1f8f08a853bbca4995bce6b0604690f174d287c316724c3d6561ea801000424c50d89a1fa32dfc634f74b32b9761dccef56ead99ae11a8d944410ed56a062e2f149abc573da7cf7dfd54e2f7d9706c56a948da436ebe6afaef55173f064606b5eaa46b2cc8956260ab06a9a157732eec03e576e2b75aebf4c3c522372520c6b229dcd8038cb6dad80e4d7b521d148ca15764705dec408001dc52b9a64b1a54bddd96993d6eed2d4e3ebbed34dbec7b686d46a9d85df0c64dd79ff3e02d6134d1f3be5200993646a4cb7f6a23c465fbc515b79b29cf508eaea9e57799de06e6165a973aa753fce5009a0f06ddbdcccca1ac4db82d92a15105f88d36131643edbb7ee175fa19d186edb12655f129c44ada70e1d52abb04c0b116822e0f21a7c6d0c8a051955b05246bf2db0d0e6cf3338271212dedc4cacbd15a25d8cff5da4c381cce1e43eddaa2a3b244ea7c30452496add33fb4565308558cfcbcbf731d1f1b330ca99412852eacd5ef4648a9de4c645eb7dcf2ae114896b4b39c2a8a360b9486746113f98d7aaec679aabac2915eb9b23923f5f6add931e727457d204e196b524b9b658806952e50b3fae4ac9831ec334bec9108241029cc03416c0b0ac581d05b09b0338cb719cecc8bd70233f8b25e08abe5f59082879ec21c2d06adb670d3584d1051719a7bf768bf08d352fe9dde68250b9fd01c1e25434c7368bed5efbe5b0776046ee466c42338d6adb47966928e89972ee09a03fa75d8b61a8d8cb158503e26f27087e07f3e53960509395d25ea0b3415f735beecb33ddcb33e875f08b97f93579dca654e2435c868b6e08d670795c02eba33eccde1ca37b541370d6748629582cd9f54b93b75411597fe1a41f495cd1d39834c4bade9e54318448a660c34de117ccb4b74428e3b68ca575713237e464899c35071070ff7c545c6b28768258bb6ade36e731c4c4619164a2401e424c8f565872785e62b31a21a3ef2e3479e86c264265b388eb63f1fb3c926985b2132192c6be80fe704b21353fba841c68a6cb78bbc6e9fdd1a5d493c3063e5f47f6ec3fbe882c8a3fc0419da30fb3ef30a18&apv_=A4E7DFE8E2BD186976167A1AA263FF7494514F9C; vendor_opay_opay=apc=60bc3a11e1e3a6e93fe3eb7d72dbc71e455785552c6baa0afbf0d31087d4dfccfb6aef67af9182302e4940835a4baa5388b526ed2e02cb10760fecfffdeeae30a2ab8d39b6760d8d2c11220d1c919add85085cbf91e694bc71113e47113b11e8407a9060854ea0062a899208b8c91d9561e8f301620dc6b647d5685aef6fd47a7ffc3dd8512ae16137db235351e270e17c4019483884fb078ecfd4816571b30dd30e5a89b6f03fc62a7e21d1b63cec32883c5b072831b9ebebb260d1b5adc7f72188febe12315cfb38ad4b8c04e619a16ff9e55c51e9e7cd28afc744e3cf00b882db7bb39d3a8b298d2d3d3d89d2c45374e441af2987732b9ff8e8de3d38c278e478eb181b820c4b1c9f1e2d6f27f6a5509abf5c7df0dbbaa7b5170cd27b315b0da08701f22507ca88dfee23e242510071e42b30bd1f1903b47235e272c0ba14a95b492557455cddea7a6fd93e2e22b554dd57e3feb3c1952ab870748a16b7ec342c5bd51938af892efa3ff69131fe8fcef89f624ba9d82628344bdf6fec091a507825bfaf37aa655f3139977b493bc586895eeffcdd01a5c6cb85b0e34e6abcdddb487773aefde286b25553bab38d0a9ceeaebbfbf5478646ce140119c355c025736b4e57353e2ce4ad82cc50df3e25bbfb887d4d27617598a597da81cde302843e83545ef267092276abfeac96792fc3ed628f647ffbd3aa95930aafeb9001d088755f71226bc05f436e4b9259dcc01d4264c7413d0411125b99f496001a98e34fd7621c63907257a75dc55012100eeca29787e66df38958d29897530306b48f7d46dec5bc936947166e46ff4be05b1da2b5f797ab0c7efe1684eaa4cbddc2aef7f4eec37115551f4316d5fd3a7a7ea3ae38f88bcb9ed50749890a26d2dae29944ca28a601f034e067152f27e9cf5998363f72273bc514c96d819b580469db7dab3b1e890b78cef3b330215bd573c0&apv=00310B0142A0945C4381229779A79B79FF93FA6F; gw_opay_opay=Field=116a52ee0d7bf17668b3d0badc778783d9e4d61a21026b6c961ca1594cd575d34631f7701f33d971247bbfcc3ae491c561ce0df5f3fa59626744e2ca82114c65f52ef8def732f443cc0495ae41a17347&Data=3ba778d4c6d3054c492ae6d51c27fe7ae8aa995c1d88eb5dc42dd40e798cdada298ab2ede8ea38f871aa742bf741a73902493e17dd0df17586a16527b2dd3b70a753949fb02f168b196872ec67c197673248c89297e3c7c520474f97d5b522c2fb22c3bf3e6b762a96706fda0de7e3c589b406d2942bd5847b87163182efc87269970cfd98a7c34aa184fe7b8122f403ff7618446728cde166a8c83de15c61c9623c103082e468229f744c4279310c81194c1eb036bf1fd0090e855188e4446a69686e0ab8ff8c2b95ef83464140679ecc15eca425ca8ed4ebf0ea7ea94ee9e3d2522e90f09b179bf49d956cbc111075390e2d6948ca075283c13c85ea1c669814dcb0a2ec341389d896d168c23e86a6d38431c79e8ae25350ebb3e9e50cb3ce8541482eea1661dba61ee6461db918c29deaada7817bbdd6990cf776b2e2f68f; ASP.NET_SessionId=ygkwwuwqjnq4lnvatxlqlitg; __RequestVerificationToken_Lw__=Oa2rOFVuFqLlIBJsJzuSxxeH9x3hS7HAZyVQaMaKEGBJpUaqpoWtGslqoQgVjppug6sPBmKmjmZObjqUr4tFBzyfYHtNlawVgDu34w7IpZNAEee6mXT+8AIuHWUzsGVOyISzE9NmhB8pmi+EyeXILbVqbow=; ASP.NET_SessionId=rg5up5fdhb5higl4jhph2dcu'
    },
    body: '__RequestVerificationToken=VQf4Xyk0cAAr7hsOewsq0kZqhq5p5Bk%2B6%2BywGg0EZP7fc0j8UswexQO4WG1WT5tQeZkvB8vX%2FT2ZqliDTaxmTkN3r%2F0ibd1qHr2r%2BD0AhObABM5l7Oyf%2BzJ%2FnEGMcUTON%2F029q4y4ebL8t%2FkdSlX4rvsvCY%3D'
  
  };
request(options, function (error, response) {
  if (error){
    console.log(error)
    res.send('failed')
  };
  res.send(response.body)
});

})

module.exports = router;
